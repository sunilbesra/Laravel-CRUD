<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post CRUD API</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<div class="container mt-5">
    <h1>Post CRUD via API</h1>

    <h3 class="mt-4">Create Post</h3>
    <form id="createPostForm">
        <div class="mb-3">
            <input type="text" id="title" placeholder="Title" class="form-control" required>
        </div>
        <div class="mb-3">
            <textarea id="content" placeholder="Content" class="form-control" rows="3" required></textarea>
        </div>
        <button type="submit" class="btn btn-success">Create Post</button>
    </form>

    <h3 class="mt-5">Posts</h3>
    <table class="table table-bordered" id="postsTable">
        <thead>
            <tr>
                <th>Title</th>
                <th>Content</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
const apiUrl = '/api/posts'; // Your Laravel API base URL

// Fetch and display posts
function fetchPosts() {
    axios.get(apiUrl)
        .then(response => {
            const tbody = document.querySelector('#postsTable tbody');
            tbody.innerHTML = '';
            response.data.forEach(post => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${post.title}</td>
                    <td>${post.content}</td>
                    <td>
                        <button class="btn btn-warning btn-sm" onclick="editPost('${post._id}')">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deletePost('${post._id}')">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        });
}

// Create new post
document.getElementById('createPostForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const title = document.getElementById('title').value;
    const content = document.getElementById('content').value;

    axios.post(apiUrl, { title, content })
        .then(() => {
            fetchPosts();
            this.reset();
        });
});

// Delete post
function deletePost(id) {
    if (confirm('Are you sure?')) {
        axios.delete(`${apiUrl}/${id}`)
            .then(() => fetchPosts());
    }
}

// Edit post
function editPost(id) {
    const newTitle = prompt('Enter new title:');
    const newContent = prompt('Enter new content:');
    if (newTitle && newContent) {
        axios.put(`${apiUrl}/${id}`, { title: newTitle, content: newContent })
            .then(() => fetchPosts());
    }
}

// Initial load
fetchPosts();
</script>
</body>
</html>
